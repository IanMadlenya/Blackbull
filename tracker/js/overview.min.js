(function(e){var d=e("#main").attr("data-pfid");var g=e("#main").attr("data-trid");var b=e("#container").attr("class");var f=0;var a=0;var c=0;e.getJSON("/serverscripts/portfolio/getOverview.php?pfid="+d+"&trid="+g+"&uuid="+b,function(q){if(q.pagefound=="1"){e("#trade_name").html(q.trade_name);e("#waitscreen").hide();e("#trade_name").show();if(q.closetotal>10){var k=0;var j=0;var n={chart:{renderTo:"chartholder",defaultSeriesType:"spline",showAxes:true,width:850,height:400},credits:{enabled:false},title:{text:q.trade_name},xAxis:{labels:{rotation:-45,align:"right"},tickmarkPlacement:"on",categories:[],reversed:true},yAxis:{labels:{formatter:function(){return this.value}},title:{text:"Price"},gridLineColor:"#DDDDDD",plotLines:[]},series:[],tooltip:{formatter:function(){if(this.point.id){var t=this.point.id.split("_");var r="Close: "+this.y+" Rs.<br/><br/>";for(var s=0;s+4<t.length;s=s+4){if(t[s+3]=="1"){r=r+"<b>Bought</b> "+t[s+2]+" share @"+t[s+1]+" Rs.<br/>"}if(t[s+3]=="-1"){r=r+"<b>Sold</b> "+t[s+2]+" share @"+t[s+1]+" Rs.<br/>"}}return r}else{return"Close: "+this.y+" Rs."}},backgroundColor:"rgba(255, 255, 255, 1)"}};var o={name:q.trade_symbol,type:"spline",data:[],color:"#06C"};if(q.transtotal>0){a=q.trans[f].trans_date;c=q.trans[f].trans_type}for(var i=0;i<q.closetotal;i++){if(k==0){k=parseFloat(q.close[i].c)}if(q.close[i].d==a){var h="";if(f+1<q.transtotal){while(q.close[i].d==a){f=f+1;if(c!=q.trans[f].trans_type){c=2}h=h+i+"_"+q.trans[f].trans_price;h=h+"_"+q.trans[f].trans_qty+"_"+q.trans[f].trans_type+"_";a=q.trans[f].trans_date;if(c!=2){c=q.trans[f].trans_type}}}else{h=h+i+"_"+q.trans[f].trans_price;h=h+"_"+q.trans[f].trans_qty+"_"+q.trans[f].trans_type+"_";a=""}if(c==1){var l={y:parseFloat(q.close[i].c),marker:{symbol:"url(http://blackbull.in/tracker/images/b.png)"},id:h}}else{if(c==-1){var l={y:parseFloat(q.close[i].c),marker:{symbol:"url(http://blackbull.in/tracker/images/s.png)"},id:h}}else{var l={y:parseFloat(q.close[i].c),marker:{symbol:"url(http://blackbull.in/tracker/images/bs.png)"},id:h}}}o.data.push(l);c=q.trans[f].trans_type}else{o.data.push(parseFloat(q.close[i].c))}n.xAxis.categories.push(q.close[i].d.substring(0,6));if(k>q.close[i].c){k=parseFloat(q.close[i].c)}if(j<q.close[i].c){j=parseFloat(q.close[i].c)}}n.series.push(o);if(q.targetstotal>0){maxValue=0;for(var m=0;m<q.targetstotal;m++){arrayelement=new Array();arrayelement.width=1;arrayelement.value=q.targets[m].target;arrayelement.color="#3cb878";arrayelement.zIndex=3;arrayelement.dashStyle="line";arrayelement.label={text:"Target: "+q.targets[m].target,style:{color:"#3cb878",fontSize:"11px"}};n.yAxis.plotLines.push(arrayelement);if(parseFloat(q.targets[m].target)>maxValue){maxValue=parseFloat(q.targets[m].target)}}if(maxValue!=0&&maxValue>j&&maxValue<(1.2*j)){n.yAxis.max=maxValue+parseInt(0.05*maxValue)}}if(q.sltotal>0){minValue=0;for(var m=0;m<q.sltotal;m++){if(m==0){minValue=parseFloat(q.sls[m].stoploss)}arrayelement=new Array();arrayelement.width=1;arrayelement.value=q.sls[m].stoploss;arrayelement.color="#D13236";arrayelement.zIndex=3;arrayelement.dashStyle="line";arrayelement.label={text:"Stoploss: "+q.sls[m].stoploss,style:{color:"#D13236",fontSize:"11px"}};n.yAxis.plotLines.push(arrayelement);if(parseFloat(q.sls[m].stoploss)<minValue){minValue=parseFloat(q.sls[m].stoploss)}}if(minValue!=0&&minValue<k&&minValue>(0.8*k)){n.yAxis.min=minValue-parseInt(0.05*minValue)}}e("#chartholder").show();var p=new Highcharts.Chart(n)}}else{e("#waitscreen").html("Page not found.");e("#waitscreen").addClass("red")}})})(this.jQuery);